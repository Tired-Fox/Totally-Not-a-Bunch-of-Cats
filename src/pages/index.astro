---
import Layout from "@layout/Layout.astro";
import "@style/animations.css";
import "@style/custom.css";

import { Carrousel, image } from "@solid/carrousel/carrousel";

import { getCollection } from "astro:content";
import { uri } from "@script/utils";

let project_posts = (await getCollection("project"))
  ?.sort(
    (a, b) =>
      (b.data.releaseDate?.valueOf() ?? 0) -
      (a.data.releaseDate?.valueOf() ?? 0)
  )
  .map(({ slug, collection, data: { title, heroImage } }) => {
    return image({
      href: uri(`${collection}/${slug}`),
      src: uri(heroImage ?? ""),
      label: title,
    });
  });
if (project_posts.length > 5) {
    project_posts = project_posts.slice(0, 5);
}
---
<!--
    References:
        - https://renegadegamestudios.com/
 -->
<Layout maxWidth={false}>
    <style>
        @media(min-width: 768px) {
          .landing-clip {
            /* CC starting top left */
            clip-path: polygon(0 0, 0 100%, 30% 100%, 90% 50%, 100% 50%, 100% 0);
          }
        }
      </style>
      <div
        id="landing-clip"
        class="w-[98%] md:w-[90%] aspect-video max-w-[1080px] mx-auto min-h-[50vh] relative mt-4 rounded-md overflow-hidden"
      >
        <iframe
          width="1920"
          height="1080"
          tabindex="-1"
          src="https://www.youtube.com/embed/LDU_Txk06tM?si=6_EbHfrSA142QQjC&amp;controls=0&autoplay=1&mute=1&showinfo=0&loop=1"
          title="YouTube video player"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen
          class="absolute left-0 top-0 w-full h-full landing-clip aspect-video"
        ></iframe>
    
        <div
         id="video-overlay"
         class="absolute top-0 left-0 w-full h-full backdrop-blur-[2px] bg-slate-700/50 landing-clip aspect-video"
        ></div>
    
        <div
         class="absolute bottom-0 right-0 bg-slate-100 shadow-sm shadow-black/50 rounded-md mb-1 mr-1 md:mr-[4rem] md:mb-[4rem] lg:mb-[6rem] py-4 px-8 max-w-[60%]"
        >
          <h1 class="text-2xl font-bold text-center">Welcome to Totally Not a Bunch of Cats</h1>
          <p class="mt-2 indent-6">A small indie game development team striving to bring fun and joy to all audiences</p>
          <a href={uri("team")} class="block text-right mt-2 underline underline-offset-2">Meet the Team</a>
        </div>
      </div>
    
      <section>
          <h2 class="text-2xl">More about us</h2>
      </section>

      <Carrousel content={project_posts} client:load full class="my-[15rem]"/>

      <section>
          <h2 class="text-2xl">Annoucements</h2>
          <a href={uri("/blog")} class="px-4 py-2 transition-colors bg-slate-500 hover:bg-slate-300 rounded-full shadow shadow-slate-700/20 text-zinc-100 block w-fit mx-auto" >More Posts</a>
      </section>
</Layout>
